$recentFolderPath = "C:\Users\Admin\AppData\Roaming\Microsoft\Windows\Recent"

# Get all LNK files in the Recent folder
$lnkFiles = Get-ChildItem -Path $recentFolderPath -Filter *.lnk

# Initialize a shell object
$shell = New-Object -COM WScript.Shell

# Specify the output file
$outputFile = "exfilter/output.txt"

# Loop through each LNK file
foreach ($lnkFile in $lnkFiles) {
    # Create a shortcut object from the LNK file
    $shortcut = $shell.CreateShortcut($lnkFile.FullName)

    # Append the target path of the shortcut to the output file
    Add-Content -Path $outputFile -Value $shortcut.TargetPath
}
